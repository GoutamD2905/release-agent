# RDK-B Release Configuration Schema
# ─────────────────────────────────────────────────────────────────────────────
# Place this file as .release-config.yml in your component repository root.
# The release agent reads this file every time it runs.
#
# To get started quickly, run:
#   ./bootstrap.sh --component-repo <org/repo> --version <version>
#
# ┌─────────────────────────────────────────────────────────────────────────┐
# │  STRATEGY — PICK ONE, NOT BOTH                                          │
# │                                                                         │
# │  "exclude"  →  Take ALL PRs from base_branch EXCEPT the ones you list  │
# │               (prs list is OPTIONAL — omit it to take every PR)        │
# │                                                                         │
# │  "include"  →  Take ONLY the PRs you explicitly list.                  │
# │               (prs list is REQUIRED)                                    │
# └─────────────────────────────────────────────────────────────────────────┘

# ── REQUIRED ──────────────────────────────────────────────────────────────────

# Target release version (semantic versioning: MAJOR.MINOR.PATCH)
version: "2.4.0"

# strategy: "exclude" or "include"
strategy: "exclude"

# prs: list of PR numbers to exclude (exclude mode) or include (include mode)
prs:
  - 205   # WIP — not ready for release
  - 310   # Experimental — needs more testing

# ── COMPONENT IDENTITY (optional but recommended) ─────────────────────────────

# Human-readable name for this component — shown in release report headers.
# Defaults to the GitHub repo name if not set.
# component_name: "rdkb-wifi"

# ── OPTIONAL ──────────────────────────────────────────────────────────────────

# Base integration branch for this component.
# Default: "develop"  (most RDK-B components use develop as integration branch)
# Override if your component uses a different branch (e.g. "main", "master")
# base_branch: "develop"

# Dry run: simulate all operations without pushing anything
dry_run: false

# Conflict policy when a cherry-pick or revert hits a conflict:
#   "pause" (default) — halt, print exact commands for owner, wait for re-run
#   "skip"            — log the conflict, skip the PR, and continue
conflict_policy: "pause"

# GitHub usernames to @mention in the auto-created draft PR
notify:
  - "@component-owner-github-handle"

# Override the release branch name (default: release/<version>)
# release_branch: "release/2.4.0"

# Override the base ref (uncomment to use a specific tag or commit as base)
# base_ref: "v2.3.0"

# ── DEPENDENCY ANALYSIS (include mode only) ───────────────────────────────────
#
# When strategy is "include", the agent analyzes whether any cherry-picked PRs
# touch the same files as non-included PRs in the develop window (potential dep).
#
# auto_resolve_deps:
#   false (default) — warn in output and report; component owner decides.
#   true            — automatically cherry-pick the dependency PR BEFORE the
#                     dependent PR, and note the reason in the report.
#
auto_resolve_deps: false

# ── SMART CONFLICT RESOLUTION ─────────────────────────────────────────────────
#
# When a cherry-pick or revert hits modify/modify conflicts in C source files,
# the smart merge engine analyzes each conflict hunk semantically and resolves
# based on the nature of the change (whitespace, includes, NULL checks, etc.).
#
# conflict_resolution:
#   smart_merge: true          # Enable semantic-aware merge (default: true)
#   min_confidence: "low"      # Reject auto-resolution below this level:
#                               #   "high"   — only whitespace, includes, comments
#                               #   "medium" — also safety improvements, brace styles
#                               #   "low"    — accept all, including fallback (default)
#   safety_prefer: true        # Always prefer side with safety improvements
#                               # (NULL checks, bounds checks, error handling)
#
conflict_resolution:
  smart_merge: true
  min_confidence: "low"
  safety_prefer: true

# ── LLM-POWERED RESOLUTION ─────────────────────────────────────────────────
#
# For functional conflicts that the regex engine can't resolve with confidence,
# the agent can call an LLM API for semantic code understanding.
#
# llm:
#   enabled: false                 # Set true to enable LLM resolution
#   provider: "openai"             # "openai" or "gemini"
#   model: "gpt-4o-mini"           # Model name (cost-effective default)
#   api_key_env: "OPENAI_API_KEY"  # Env var containing the API key
#   temperature: 0.1               # Low = deterministic
#   max_calls_per_run: 5           # Rate limit per release run
#   timeout_seconds: 10            # Per-call timeout
#
llm:
  enabled: false
  provider: "openai"
  model: "gpt-4o-mini"
  api_key_env: "OPENAI_API_KEY"
  temperature: 0.1
  max_calls_per_run: 5
  timeout_seconds: 10
